
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Matteo Belenchia">
      
      
        <link rel="canonical" href="https://quasylab.github.io/mG/reference/API_reference/compiler/">
      
      
        <link rel="prev" href="../../grammar/">
      
      
        <link rel="next" href="../data/">
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>compiler - libmg</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#libmg.compiler.PsiLocal" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="libmg" class="md-header__button md-logo" aria-label="libmg" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis" style="font-variant:small-caps;">
            libmg
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              compiler
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/quasylab/mG" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../tutorials/" class="md-tabs__link">
        
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../how-to_guides/" class="md-tabs__link">
        
  
    
  
  How-To Guides

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../" class="md-tabs__link">
        
  
    
  
  Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../explanation/" class="md-tabs__link">
        
  
    
  
  Explanation

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="libmg" class="md-nav__button md-logo" aria-label="libmg" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    libmg
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/quasylab/mG" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tutorials/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/ctl-mc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CTL Model Checking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tutorials/gcn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graph Convolutional Networks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../how-to_guides/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    How-To Guides
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-To Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to define a dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to define functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/compiler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to define a compiler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to create, run and optimize models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../how-to_guides/visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualization procedures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../grammar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grammar Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" checked>
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    compiler
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    compiler
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiLocal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiLocal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiGlobal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiGlobal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiNonLocal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiNonLocal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Phi" class="md-nav__link">
    <span class="md-ellipsis">
      Phi
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma" class="md-nav__link">
    <span class="md-ellipsis">
      Sigma
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sigma">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Constant" class="md-nav__link">
    <span class="md-ellipsis">
      Constant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Pi" class="md-nav__link">
    <span class="md-ellipsis">
      Pi
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.NodeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      NodeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.EdgeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      EdgeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CompilerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CompilerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.node_feature_type" class="md-nav__link">
    <span class="md-ellipsis">
      node_feature_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.node_feature_size" class="md-nav__link">
    <span class="md-ellipsis">
      node_feature_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.edge_feature_type" class="md-nav__link">
    <span class="md-ellipsis">
      edge_feature_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.edge_feature_size" class="md-nav__link">
    <span class="md-ellipsis">
      edge_feature_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.matrix_type" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.use_edges" class="md-nav__link">
    <span class="md-ellipsis">
      use_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.tolerance" class="md-nav__link">
    <span class="md-ellipsis">
      tolerance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.use_multiple_loader" class="md-nav__link">
    <span class="md-ellipsis">
      use_multiple_loader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.input_spec" class="md-nav__link">
    <span class="md-ellipsis">
      input_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xa_config" class="md-nav__link">
    <span class="md-ellipsis">
      xa_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xai_config" class="md-nav__link">
    <span class="md-ellipsis">
      xai_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xae_config" class="md-nav__link">
    <span class="md-ellipsis">
      xae_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xaei_config" class="md-nav__link">
    <span class="md-ellipsis">
      xaei_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler" class="md-nav__link">
    <span class="md-ellipsis">
      MGCompiler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MGCompiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler.compile" class="md-nav__link">
    <span class="md-ellipsis">
      compile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler.trace" class="md-nav__link">
    <span class="md-ellipsis">
      trace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_uoperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_uoperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_boperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_boperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_koperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_koperator
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../explainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    explainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../language/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../normalizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    normalizer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../verifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    verifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualizer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visualizer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../explanation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Explanation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../explanation/semantics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syntax and Semantics of μG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../explanation/reduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../explanation/explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation of μG models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiLocal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiLocal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiLocal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiGlobal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiGlobal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiGlobal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal" class="md-nav__link">
    <span class="md-ellipsis">
      PsiNonLocal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PsiNonLocal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.PsiNonLocal.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Phi" class="md-nav__link">
    <span class="md-ellipsis">
      Phi
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Phi.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma" class="md-nav__link">
    <span class="md-ellipsis">
      Sigma
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sigma">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Sigma.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Constant" class="md-nav__link">
    <span class="md-ellipsis">
      Constant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Constant.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.Pi" class="md-nav__link">
    <span class="md-ellipsis">
      Pi
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.fname" class="md-nav__link">
    <span class="md-ellipsis">
      fname
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.Pi.make_parametrized" class="md-nav__link">
    <span class="md-ellipsis">
      make_parametrized
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.NodeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      NodeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.EdgeConfig" class="md-nav__link">
    <span class="md-ellipsis">
      EdgeConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CompilerConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CompilerConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.node_feature_type" class="md-nav__link">
    <span class="md-ellipsis">
      node_feature_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.node_feature_size" class="md-nav__link">
    <span class="md-ellipsis">
      node_feature_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.edge_feature_type" class="md-nav__link">
    <span class="md-ellipsis">
      edge_feature_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.edge_feature_size" class="md-nav__link">
    <span class="md-ellipsis">
      edge_feature_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.matrix_type" class="md-nav__link">
    <span class="md-ellipsis">
      matrix_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.use_edges" class="md-nav__link">
    <span class="md-ellipsis">
      use_edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.tolerance" class="md-nav__link">
    <span class="md-ellipsis">
      tolerance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.use_multiple_loader" class="md-nav__link">
    <span class="md-ellipsis">
      use_multiple_loader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.input_spec" class="md-nav__link">
    <span class="md-ellipsis">
      input_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xa_config" class="md-nav__link">
    <span class="md-ellipsis">
      xa_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xai_config" class="md-nav__link">
    <span class="md-ellipsis">
      xai_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xae_config" class="md-nav__link">
    <span class="md-ellipsis">
      xae_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.CompilerConfig.xaei_config" class="md-nav__link">
    <span class="md-ellipsis">
      xaei_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler" class="md-nav__link">
    <span class="md-ellipsis">
      MGCompiler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MGCompiler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler.compile" class="md-nav__link">
    <span class="md-ellipsis">
      compile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#libmg.compiler.MGCompiler.trace" class="md-nav__link">
    <span class="md-ellipsis">
      trace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_uoperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_uoperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_boperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_boperator
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libmg.compiler.make_koperator" class="md-nav__link">
    <span class="md-ellipsis">
      make_koperator
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>compiler</h1>

<div class="doc doc-object doc-module">




  <div class="doc doc-contents first">
  
      <p>Defines the mG compiler and the basic mG functions.</p>
<p>This package defines a compiler for mG programs and the data structures to instantiate it. It also provides the various classes that allow for the definition
of mG functions.</p>
<p>The package contains the following classes:</p>
<ul>
<li><code>NodeConfig</code></li>
<li><code>EdgeConfig</code></li>
<li><code>CompilerConfig</code></li>
<li><code>MGCompiler</code></li>
<li><code>PsiNonLocal</code></li>
<li><code>PsiLocal</code></li>
<li><code>PsiGlobal</code></li>
<li><code>Phi</code></li>
<li><code>Sigma</code></li>
<li><code>Constant</code></li>
<li><code>Pi</code></li>
</ul>
<p>The module contains the following functions:</p>
<ul>
<li><code>make_uoperator(op, name)</code></li>
<li><code>make_boperator(op, name)</code></li>
<li><code>make_koperator(op, name)</code></li>
</ul>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.PsiLocal" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PsiLocal</span>


<a href="#libmg.compiler.PsiLocal" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">PsiLocal</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.functions.Psi">Psi</span></code></p>

  
      <p>A psi function of the mG language that only applies a local transformation of node labels.</p>
<p>A local transformation of node labels <span class="arithmatex">\(\psi: T \rightarrow U\)</span>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiLocal</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add1&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;PsiLocal ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that this object will run when called. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor X with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and return a tensor of shape <code>(n_nodes, n_new_node_features)</code>, containing the transformed labels.
The function is not supposed to use global information, but this is not enforced.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function and a name.</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    Args:</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        f: The function that this object will run when called. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            rules. The function is expected to take in input a tensor X with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            every node in the graph, and return a tensor of shape ``(n_nodes, n_new_node_features)``, containing the transformed labels.</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            The function is not supposed to use global information, but this is not enforced.</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.PsiLocal.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.PsiLocal.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiLocal.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiLocal.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Proj3&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span></code>)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided function ``f`` and ``name``.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    of the function.</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; Phi.make(&#39;Proj3&#39;, lambda i, e, j: j)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        f: The function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>  <span class="c1"># if f is a layer, regenerate from config to get new weights</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_config</span><span class="p">()),</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiLocal.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiLocal.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code>
 returns an instance of <code>cls</code> initialized with the result of the application of <code>a</code> to the function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function. The function <code>f</code> may have the form <code>lambda x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned
by this function corresponds to the <code>x</code> argument of <code>f</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>f</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a``</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">     returns an instance of ``cls`` initialized with the result of the application of ``a`` to the function ``f`` and ``name``.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    of the function. The function ``f`` may have the form ``lambda x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    by this function corresponds to the ``x`` argument of ``f``.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y: lambda i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y, i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        name: The name of the function returned by ``f``.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        f: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># check if f has only a single argument e.g. lambda x: lambda y: foo(x)(y)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># e.g. lambda x, y: foo(x)(y)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.PsiGlobal" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PsiGlobal</span>


<a href="#libmg.compiler.PsiGlobal" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">PsiGlobal</span><span class="p">(</span><span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="libmg.compiler.functions.PsiNonLocal" href="#libmg.compiler.PsiNonLocal">PsiNonLocal</a></code></p>

  
      <p>A psi function of the mG language that only applies a global transformation of node labels.</p>
<p>A global transformation (i.e. pooling) of node labels <span class="arithmatex">\(\psi: T^* \rightarrow U\)</span>. For single graph datasets, which use the
<code>SingleGraphLoader</code>, only the <code>single_op</code> parameter is necessary. For multiple graph datasets, using the
<code>MultipleGraphLoader</code>, only the <code>multiple_op</code> parameter is necessary. The <code>multiple_op</code> argument is a function which
takes an additional parameter to distinguish which values in the first argument refer to which graph. For
more information, refer to the disjoint data mode in the Spektral library <code>documentation &lt;https://graphneural.network/data-modes/#disjoint-mode/&gt;</code>_.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiGlobal</span><span class="p">(</span><span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">segment_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;SumPooling&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;PsiGlobal ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function to be used in conjunction with a <code>SingleGraphLoader</code>.
The function is expected to take in input a tensor X with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and return a tensor of shape <code>(n_pooled_features, )</code>, containing the pooled output. This output is then broadcast to
label every node.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function to be used in conjunction with a <code>MultipleGraphLoader</code>.
The function is expected to take in input a tensor with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and a tensor of graph indices of shape <code>(n_nodes, 1)</code>, that mark to which graph every node belongs. The function is
expected to return a tensor of shape <code>(n_graphs, n_pooled_features)</code> containing the pooled outputs for each distinct graph index. This output
is then broadcast to label every node of each graph with the pooled features for that graph.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>             <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function for a single graph and/or a function a multiple graph operation, and a name.</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    Args:</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        single_op: The function to be used in conjunction with a ``SingleGraphLoader``.</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            The function is expected to take in input a tensor X with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">            every node in the graph, and return a tensor of shape ``(n_pooled_features, )``, containing the pooled output. This output is then broadcast to</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            label every node.</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        multiple_op: The function to be used in conjunction with a ``MultipleGraphLoader``.</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            The function is expected to take in input a tensor with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            every node in the graph, and a tensor of graph indices of shape ``(n_nodes, 1)``, that mark to which graph every node belongs. The function is</span>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            expected to return a tensor of shape ``(n_graphs, n_pooled_features)`` containing the pooled outputs for each distinct graph index. This output</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            is then broadcast to label every node of each graph with the pooled features for that graph.</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">single_op</span><span class="o">=</span><span class="n">single_op</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="n">multiple_op</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.PsiGlobal.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.PsiGlobal.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiGlobal.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiGlobal.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">PsiNonLocal</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided functions <code>single_op</code> and/or
<code>multiple_op</code> and <code>name</code>.</p>
<p>Calling this method on a <code>PsiNonLocal</code> class creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that
function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,
which are not supposed to be shared with other instances of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Successor&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function PsiNonLocal.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>single_op</code> and <code>multiple_op</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code> as the <code>single_op</code> argument.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code> as the <code>multiple_op</code> argument.</p>
        </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>Neither <code>single_op</code> nor <code>multiple_op</code> have been provided.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">PsiNonLocal</span><span class="p">]:</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided functions ``single_op`` and/or</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    ``multiple_op`` and ``name``.</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Calling this method on a ``PsiNonLocal`` class creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    which are not supposed to be shared with other instances of the function.</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make(&#39;Successor&#39;, lambda x: x + 1)</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        &lt;function PsiNonLocal.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Args:</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        name: The name of the function returned by ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        single_op: The function that will be used to instantiate ``cls`` as the ``single_op`` argument.</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        multiple_op: The function that will be used to instantiate ``cls`` as the ``multiple_op`` argument.</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        ValueError: Neither ``single_op`` nor ``multiple_op`` have been provided.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one function must be provided.&quot;</span><span class="p">)</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;single_op&#39;</span> <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">PsiLocal</span> <span class="k">else</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_op</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">if</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;multiple_op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiple_op</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiGlobal.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiGlobal.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">PsiNonLocal</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code> returns an instance of <code>cls</code> initialized with the result of the
 application of <code>a</code> to the function <code>single_op</code> and/or <code>multiple_op</code>, and <code>name</code>.</p>
<p>Calling this method on a <code>PsiNonLocal</code> class creates a one-argument lambda that returns an instance of such subclass. This way, whenever that
function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,
which are not supposed to be shared with other instances of the function. The functions <code>single_op</code> and <code>multiple_op</code> may have the form <code>lambda
x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned by this function corresponds to the <code>x</code> argument of
<code>single_op</code> and <code>multiple_op</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>single_op</code> and <code>multiple_op</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>as the
<code>single_op</code> argument.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code> as the
<code>multiple_op</code> argument.</p>
        </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>Neither <code>single_op</code> nor <code>multiple_op</code> have been provided.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>                      <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">PsiNonLocal</span><span class="p">]:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a`` returns an instance of ``cls`` initialized with the result of the</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">     application of ``a`` to the function ``single_op`` and/or ``multiple_op``, and ``name``.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Calling this method on a ``PsiNonLocal`` class creates a one-argument lambda that returns an instance of such subclass. This way, whenever that</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    which are not supposed to be shared with other instances of the function. The functions ``single_op`` and ``multiple_op`` may have the form ``lambda</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned by this function corresponds to the ``x`` argument of</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make_parametrized(name=&#39;Add&#39;, single_op=lambda y: lambda x: x + y, multiple_op=lambda y: lambda x, i: x + y)</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make_parametrized( name=&#39;Add&#39;, single_op=lambda y, x: x + y, multiple_op=lambda y, x, i: x + y)</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Args:</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        name: The name of the function returned by ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        single_op: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``as the</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            ``single_op`` argument.</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        multiple_op: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls`` as the</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            ``multiple_op`` argument.</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        ValueError: Neither ``single_op`` nor ``multiple_op`` have been provided.</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one function must be provided.&quot;</span><span class="p">)</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;single_op&#39;</span> <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">PsiLocal</span> <span class="k">else</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_op</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">if</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;multiple_op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiple_op</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">partial</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>                         <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.PsiNonLocal" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">PsiNonLocal</span>


<a href="#libmg.compiler.PsiNonLocal" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">PsiNonLocal</span><span class="p">(</span><span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.functions.Psi">Psi</span></code></p>

  
      <p>A psi function of the mG language.</p>
<p>A non-local function applied on node labels <span class="arithmatex">\(\psi: T^* \times T \rightarrow U\)</span>. For single graph datasets, which use the
<code>SingleGraphLoader</code>, only the <code>single_op</code> parameter is necessary. For multiple graph datasets, using the
<code>MultipleGraphLoader</code>, only the <code>multiple_op</code> parameter is necessary. The <code>multiple_op</code> argument is a function which
takes an additional parameter to distinguish which values in the first argument refer to which graph. For
more information, refer to the disjoint data mode in the Spektral library <code>documentation &lt;https://graphneural.network/data-modes/#disjoint-mode/&gt;</code>_.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="p">(</span><span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add1&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;PsiNonLocal ...&gt;</span>
</span></code></pre></div>



  <p>Attributes:</p>
  <ul>
      <li class="field-body">
        <b><code><span title="libmg.compiler.PsiNonLocal.single_op">single_op</span></code></b>
        –
        <div class="doc-md-description">
          <p>A function to be used in conjunction with a <code>SingleGraphLoader</code></p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="libmg.compiler.PsiNonLocal.multiple_op">multiple_op</span></code></b>
        –
        <div class="doc-md-description">
          <p>A function to be used in conjunction with a <code>MultipleGraphLoader</code></p>
        </div>
      </li>
  </ul>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function to be used in conjunction with a <code>SingleGraphLoader</code>. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor X with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and return a tensor of shape <code>(n_nodes, n_new_node_features)</code>, containing the transformed labels.
The function can use broadcasting to emulate the tuple (T*, T) in the definition of psi.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function to be used in conjunction with a <code>MultipleGraphLoader</code>. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor X with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and a tensor of graph indices of shape <code>(n_nodes, 1)</code>, that mark to which graph every node belongs. The function is
expected to return a tensor of shape <code>(n_nodes, n_new_node_features)</code> containing the transformed labels.
The function can use broadcasting to emulate the tuple (T*, T) in the definition of psi.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245"></a>             <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246"></a>             <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function for a single graph and/or a function a multiple graph operation, and a name.</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248"></a>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Args:</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        single_op: The function to be used in conjunction with a ``SingleGraphLoader``. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            rules. The function is expected to take in input a tensor X with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            every node in the graph, and return a tensor of shape ``(n_nodes, n_new_node_features)``, containing the transformed labels.</span>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            The function can use broadcasting to emulate the tuple (T*, T) in the definition of psi.</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        multiple_op: The function to be used in conjunction with a ``MultipleGraphLoader``. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            rules. The function is expected to take in input a tensor X with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            every node in the graph, and a tensor of graph indices of shape ``(n_nodes, 1)``, that mark to which graph every node belongs. The function is</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            expected to return a tensor of shape ``(n_nodes, n_new_node_features)`` containing the transformed labels.</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            The function can use broadcasting to emulate the tuple (T*, T) in the definition of psi.</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single_op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">single_graph_op</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">single_op</span> <span class="o">=</span> <span class="n">single_op</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">if</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">multiple_op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiple_graph_op</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">multiple_op</span> <span class="o">=</span> <span class="n">multiple_op</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">single_op</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.PsiNonLocal.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.PsiNonLocal.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiNonLocal.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiNonLocal.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">PsiNonLocal</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided functions <code>single_op</code> and/or
<code>multiple_op</code> and <code>name</code>.</p>
<p>Calling this method on a <code>PsiNonLocal</code> class creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that
function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,
which are not supposed to be shared with other instances of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Successor&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function PsiNonLocal.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>single_op</code> and <code>multiple_op</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code> as the <code>single_op</code> argument.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span> | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code> as the <code>multiple_op</code> argument.</p>
        </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>Neither <code>single_op</code> nor <code>multiple_op</code> have been provided.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">PsiNonLocal</span><span class="p">]:</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided functions ``single_op`` and/or</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    ``multiple_op`` and ``name``.</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281"></a>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Calling this method on a ``PsiNonLocal`` class creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    which are not supposed to be shared with other instances of the function.</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285"></a>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make(&#39;Successor&#39;, lambda x: x + 1)</span>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        &lt;function PsiNonLocal.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289"></a>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Args:</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        name: The name of the function returned by ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        single_op: The function that will be used to instantiate ``cls`` as the ``single_op`` argument.</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        multiple_op: The function that will be used to instantiate ``cls`` as the ``multiple_op`` argument.</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294"></a>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        ValueError: Neither ``single_op`` nor ``multiple_op`` have been provided.</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one function must be provided.&quot;</span><span class="p">)</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;single_op&#39;</span> <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">PsiLocal</span> <span class="k">else</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_op</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">if</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;multiple_op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiple_op</span>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.PsiNonLocal.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.PsiNonLocal.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">PsiNonLocal</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code> returns an instance of <code>cls</code> initialized with the result of the
 application of <code>a</code> to the function <code>single_op</code> and/or <code>multiple_op</code>, and <code>name</code>.</p>
<p>Calling this method on a <code>PsiNonLocal</code> class creates a one-argument lambda that returns an instance of such subclass. This way, whenever that
function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,
which are not supposed to be shared with other instances of the function. The functions <code>single_op</code> and <code>multiple_op</code> may have the form <code>lambda
x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned by this function corresponds to the <code>x</code> argument of
<code>single_op</code> and <code>multiple_op</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">PsiNonLocal</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="n">single_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">multiple_op</span><span class="o">=</span><span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>single_op</code> and <code>multiple_op</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>single_op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>as the
<code>single_op</code> argument.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code> as the
<code>multiple_op</code> argument.</p>
        </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>Neither <code>single_op</code> nor <code>multiple_op</code> have been provided.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309"></a>                      <span class="n">multiple_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">PsiNonLocal</span><span class="p">]:</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a`` returns an instance of ``cls`` initialized with the result of the</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">     application of ``a`` to the function ``single_op`` and/or ``multiple_op``, and ``name``.</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312"></a>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Calling this method on a ``PsiNonLocal`` class creates a one-argument lambda that returns an instance of such subclass. This way, whenever that</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    function is used in a mG program, the dictionary automatically regenerates the instance. This is useful when the function has trainable weights,</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    which are not supposed to be shared with other instances of the function. The functions ``single_op`` and ``multiple_op`` may have the form ``lambda</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned by this function corresponds to the ``x`` argument of</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318"></a>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make_parametrized(name=&#39;Add&#39;, single_op=lambda y: lambda x: x + y, multiple_op=lambda y: lambda x, i: x + y)</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &gt;&gt;&gt; PsiNonLocal.make_parametrized( name=&#39;Add&#39;, single_op=lambda y, x: x + y, multiple_op=lambda y, x, i: x + y)</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &lt;function PsiNonLocal.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324"></a>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Args:</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        name: The name of the function returned by ``single_op`` and ``multiple_op``.</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        single_op: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``as the</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            ``single_op`` argument.</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        multiple_op: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls`` as the</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            ``multiple_op`` argument.</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331"></a>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        ValueError: Neither ``single_op`` nor ``multiple_op`` have been provided.</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one function must be provided.&quot;</span><span class="p">)</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="k">if</span> <span class="n">single_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;single_op&#39;</span> <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">PsiLocal</span> <span class="k">else</span> <span class="s1">&#39;f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">single_op</span>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="k">if</span> <span class="n">multiple_op</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;multiple_op&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiple_op</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">partial</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343"></a>                         <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.Phi" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Phi</span>


<a href="#libmg.compiler.Phi" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Phi</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.functions.Function">Function</span></code></p>

  
      <p>A phi function of the mG language.</p>
<p>A function <span class="arithmatex">\(\varphi: T \times U \times T \rightarrow V\)</span> to compute the message sent by a node i to a node j through edge e.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">e</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;EdgeProd&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;Phi ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[tuple[<span title="tensorflow.Tensor">Tensor</span>, ...], <span title="tensorflow.Tensor">Tensor</span>, tuple[<span title="tensorflow.Tensor">Tensor</span>, ...]], <span title="tensorflow.Tensor">Tensor</span> | tuple[<span title="tensorflow.Tensor">Tensor</span>, ...]] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that this object will run when called. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor X1 with shape <code>(n_edges, n_node_features)</code>, containing the labels of
all nodes sending a message, a tensor E with shape <code>(n_edges, n_edge_features)</code>, containing the labels of all edges in the graph, and a tensor
X2, containing the labels of all nodes receiving a message. The function is expected to return a tensor with shape
<code>(n_edges, n_message_features)</code>, containing the messages to be sent to the destination nodes.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-441"><a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-442"><a id="__codelineno-0-442" name="__codelineno-0-442"></a>             <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-443"><a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function and a name.</span>
</span><span id="__span-0-444"><a id="__codelineno-0-444" name="__codelineno-0-444"></a>
</span><span id="__span-0-445"><a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    Args:</span>
</span><span id="__span-0-446"><a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">        f: The function that this object will run when called. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-447"><a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">            rules. The function is expected to take in input a tensor X1 with shape ``(n_edges, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-448"><a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">            all nodes sending a message, a tensor E with shape ``(n_edges, n_edge_features)``, containing the labels of all edges in the graph, and a tensor</span>
</span><span id="__span-0-449"><a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            X2, containing the labels of all nodes receiving a message. The function is expected to return a tensor with shape</span>
</span><span id="__span-0-450"><a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            ``(n_edges, n_message_features)``, containing the messages to be sent to the destination nodes.</span>
</span><span id="__span-0-451"><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-452"><a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-453"><a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-454"><a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</span><span id="__span-0-455"><a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.Phi.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.Phi.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Phi.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Phi.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Proj3&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span></code>)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided function ``f`` and ``name``.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    of the function.</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; Phi.make(&#39;Proj3&#39;, lambda i, e, j: j)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        f: The function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>  <span class="c1"># if f is a layer, regenerate from config to get new weights</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_config</span><span class="p">()),</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Phi.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Phi.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code>
 returns an instance of <code>cls</code> initialized with the result of the application of <code>a</code> to the function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function. The function <code>f</code> may have the form <code>lambda x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned
by this function corresponds to the <code>x</code> argument of <code>f</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>f</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a``</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">     returns an instance of ``cls`` initialized with the result of the application of ``a`` to the function ``f`` and ``name``.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    of the function. The function ``f`` may have the form ``lambda x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    by this function corresponds to the ``x`` argument of ``f``.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y: lambda i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y, i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        name: The name of the function returned by ``f``.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        f: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># check if f has only a single argument e.g. lambda x: lambda y: foo(x)(y)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># e.g. lambda x, y: foo(x)(y)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.Sigma" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Sigma</span>


<a href="#libmg.compiler.Sigma" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Sigma</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.functions.Function">Function</span></code></p>

  
      <p>A sigma function of the mG language.</p>
<p>A function <span class="arithmatex">\(\sigma: T^* \times U \rightarrow V\)</span> to aggregate the messages sent to a node, including the current label of the node.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Sigma</span><span class="p">(</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">segment_max</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Max&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;Sigma ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[tuple[<span title="tensorflow.Tensor">Tensor</span>, ...], <span title="tensorflow.Tensor">Tensor</span>, int, tuple[<span title="tensorflow.Tensor">Tensor</span>, ...]], <span title="tensorflow.Tensor">Tensor</span> | tuple[<span title="tensorflow.Tensor">Tensor</span>, ...]] | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The function that this object will run when called. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor M with shape <code>(n_edges, n_message_features)</code>, containing the generated messages,
a tensor IDX with shape <code>(n_edges,)</code>, containing the ids of the node each message is being sent to, the total number of the nodes involved,
and a tensor X, containing the current node labels. The function is expected to return a tensor with shape
<code>(n_nodes, n_new_node_features)</code>, containing the new node labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a>             <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function and a name.</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">    Args:</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        f: The function that this object will run when called. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            rules. The function is expected to take in input a tensor M with shape ``(n_edges, n_message_features)``, containing the generated messages,</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            a tensor IDX with shape ``(n_edges,)``, containing the ids of the node each message is being sent to, the total number of the nodes involved,</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            and a tensor X, containing the current node labels. The function is expected to return a tensor with shape</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">            ``(n_nodes, n_new_node_features)``, containing the new node labels.</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.Sigma.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.Sigma.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Sigma.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Sigma.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Proj3&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span></code>)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided function ``f`` and ``name``.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    of the function.</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; Phi.make(&#39;Proj3&#39;, lambda i, e, j: j)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        f: The function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>  <span class="c1"># if f is a layer, regenerate from config to get new weights</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_config</span><span class="p">()),</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Sigma.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Sigma.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code>
 returns an instance of <code>cls</code> initialized with the result of the application of <code>a</code> to the function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function. The function <code>f</code> may have the form <code>lambda x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned
by this function corresponds to the <code>x</code> argument of <code>f</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>f</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a``</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">     returns an instance of ``cls`` initialized with the result of the application of ``a`` to the function ``f`` and ``name``.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    of the function. The function ``f`` may have the form ``lambda x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    by this function corresponds to the ``x`` argument of ``f``.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y: lambda i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y, i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        name: The name of the function returned by ``f``.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        f: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># check if f has only a single argument e.g. lambda x: lambda y: foo(x)(y)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># e.g. lambda x, y: foo(x)(y)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.Constant" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Constant</span>


<a href="#libmg.compiler.Constant" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Constant</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="libmg.compiler.functions.PsiLocal" href="#libmg.compiler.PsiLocal">PsiLocal</a></code></p>

  
      <p>A constant psi function of the mG language.</p>
<p>A constant function <span class="arithmatex">\(\psi: T \rightarrow U\)</span> that maps every node label to a constant value.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Constant</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="kc">False</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;Constant ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>v</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>A scalar or tensor value that identifies the constant function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with a function and a name.</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    Args:</span>
</span><span id="__span-0-512"><a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        v: A scalar or tensor value that identifies the constant function.</span>
</span><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">if</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_all</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)):</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a>    <span class="k">elif</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_all</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)):</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="k">elif</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">fill</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">v</span><span class="p">)),</span> <span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">([</span><span class="n">v</span><span class="p">],</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.Constant.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.Constant.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Constant.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Constant.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Proj3&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span></code>)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided function ``f`` and ``name``.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    of the function.</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; Phi.make(&#39;Proj3&#39;, lambda i, e, j: j)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        f: The function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>  <span class="c1"># if f is a layer, regenerate from config to get new weights</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_config</span><span class="p">()),</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Constant.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Constant.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code>
 returns an instance of <code>cls</code> initialized with the result of the application of <code>a</code> to the function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function. The function <code>f</code> may have the form <code>lambda x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned
by this function corresponds to the <code>x</code> argument of <code>f</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>f</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a``</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">     returns an instance of ``cls`` initialized with the result of the application of ``a`` to the function ``f`` and ``name``.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    of the function. The function ``f`` may have the form ``lambda x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    by this function corresponds to the ``x`` argument of ``f``.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y: lambda i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y, i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        name: The name of the function returned by ``f``.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        f: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># check if f has only a single argument e.g. lambda x: lambda y: foo(x)(y)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># e.g. lambda x, y: foo(x)(y)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.Pi" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Pi</span>


<a href="#libmg.compiler.Pi" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Pi</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="libmg.compiler.functions.PsiLocal" href="#libmg.compiler.PsiLocal">PsiLocal</a></code></p>

  
      <p>A projection psi function of the mG language.</p>
<p>A projection function <span class="arithmatex">\(\psi: T^n \rightarrow T^m\)</span> that maps every node label to a projection of itself.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Pi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;FirstTwo&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;Pi ...&gt;</span>
</span></code></pre></div>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>i</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>0-based index, start position of the projection function, inclusive.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>j</code></b>
            (<code>int | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>end position of the projection function, exclusive. Defaults to i + 1.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>start and end index are equal.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with the projection indexes and a name.</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    Args:</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        i: 0-based index, start position of the projection function, inclusive.</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        j: end position of the projection function, exclusive. Defaults to i + 1.</span>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        ValueError: start and end index are equal.</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">j</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Start index and end index cannot be equal.&quot;</span><span class="p">)</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
</span><span id="__span-0-556"><a id="__codelineno-0-556" name="__codelineno-0-556"></a>
</span><span id="__span-0-557"><a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.Pi.fname" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fname</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.Pi.fname" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fname</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The name of this function. This can be either the name provided during initialization, if it was provided, or the dynamic class name.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Pi.make" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Pi.make" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a zero-argument function that when called returns an instance of <code>cls</code> initialized with the provided function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;Proj3&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span></code>)
        –
        <div class="doc-md-description">
          <p>The function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a zero-argument function that when called returns an instance of ``cls`` initialized with the provided function ``f`` and ``name``.</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    creates a zero-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    of the function.</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; Phi.make(&#39;Proj3&#39;, lambda i, e, j: j)</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &lt;function Function.make.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Args:</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        name: The name of the function.</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        f: The function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Layer</span><span class="p">):</span>  <span class="c1"># if f is a layer, regenerate from config to get new weights</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_config</span><span class="p">()),</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.Pi.make_parametrized" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parametrized</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#libmg.compiler.Pi.make_parametrized" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_parametrized</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a one-argument function that when called with the argument <code>a</code>
 returns an instance of <code>cls</code> initialized with the result of the application of <code>a</code> to the function <code>f</code> and <code>name</code>.</p>
<p>The class <code>cls</code> is supposed to be a <code>Function</code> subclass. Calling this method on a suitable <code>Function</code> subclass
creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary
automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances
of the function. The function <code>f</code> may have the form <code>lambda x: lambda ... : ...</code> or <code>lambda x, ... : ...</code>. The one argument of the lambda returned
by this function corresponds to the <code>x</code> argument of <code>f</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">Phi</span><span class="o">.</span><span class="n">make_parametrized</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">j</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span></code></pre></div>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>)
        –
        <div class="doc-md-description">
          <p>The name of the function returned by <code>f</code>.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>f</code></b>
            (<code><span title="typing.Callable">Callable</span>[[str], <span title="typing.Callable">Callable</span>] | <span title="typing.Callable">Callable</span>[..., <span title="typing.Any">Any</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The function that when applied to some argument <code>a</code> returns the function that will be used to instantiate <code>cls</code>.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="nd">@classmethod</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span> <span class="nf">make_parametrized</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">T_A</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">T_A</span><span class="p">]:</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a one-argument function that when called with the argument ``a``</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">     returns an instance of ``cls`` initialized with the result of the application of ``a`` to the function ``f`` and ``name``.</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    The class ``cls`` is supposed to be a ``Function`` subclass. Calling this method on a suitable ``Function`` subclass</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    creates a one-argument lambda that returns an instance of such subclass. This way, whenever that function is used in a mG program, the dictionary</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    automatically regenerates the instance. This is useful when the function has trainable weights, which are not supposed to be shared with other instances</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    of the function. The function ``f`` may have the form ``lambda x: lambda ... : ...`` or ``lambda x, ... : ...``. The one argument of the lambda returned</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    by this function corresponds to the ``x`` argument of ``f``.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Examples:</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y: lambda i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        &gt;&gt;&gt; Phi.make_parametrized(&#39;Add&#39;, lambda y, i, e, j: j + int(y) * e)</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        &lt;function Function.make_parametrized.&lt;locals&gt;.&lt;lambda&gt; at 0x...&gt;</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        name: The name of the function returned by ``f``.</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        f: The function that when applied to some argument ``a`` returns the function that will be used to instantiate ``cls``.</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="c1"># check if f has only a single argument e.g. lambda x: lambda y: foo(x)(y)</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># e.g. lambda x, y: foo(x)(y)</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">return</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="bp">cls</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">a</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.NodeConfig" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">NodeConfig</span>


<a href="#libmg.compiler.NodeConfig" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">NodeConfig</span><span class="p">(</span><span class="n">node_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">node_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.compiler.LabelConfig">LabelConfig</span></code></p>

  
      <p>Defines the signature of a node label.</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>Type of the node labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>node_size</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Dimension of the node labels.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">node_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with the given type and dimension.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65"></a>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    Args:</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        node_type: Type of the node labels.</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        node_size: Dimension of the node labels.</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">node_type</span><span class="p">,</span> <span class="n">node_size</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.EdgeConfig" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">EdgeConfig</span>


<a href="#libmg.compiler.EdgeConfig" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">EdgeConfig</span><span class="p">(</span><span class="n">edge_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">edge_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="libmg.compiler.compiler.LabelConfig">LabelConfig</span></code></p>

  
      <p>Defines the signature of an edge label.</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>edge_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>Type of the edge labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>edge_size</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Dimension of the edge labels.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">edge_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with the given type and dimension.</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79"></a>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    Args:</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        edge_type: Type of the edge labels.</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        edge_size: Dimension of the edge labels.</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">edge_type</span><span class="p">,</span> <span class="n">edge_size</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.CompilerConfig" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">CompilerConfig</span>


<a href="#libmg.compiler.CompilerConfig" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">CompilerConfig</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">multiple_loader</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">

  
      <p>Defines the configuration for the mG compiler.</p>
<p>It is recommended to use the static constructor methods to instantiate this class.</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.NodeConfig" href="#libmg.compiler.NodeConfig">NodeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial node labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>edge_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.EdgeConfig" href="#libmg.compiler.EdgeConfig">EdgeConfig</a> | None</code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial edge labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>matrix_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the adjacency matrix of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>tolerance</code></b>
            (<code>dict[str, float]</code>)
        –
        <div class="doc-md-description">
          <p>The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>multiple_loader</code></b>
            (<code>bool</code>)
        –
        <div class="doc-md-description">
          <p>True if the models generated by the mG compiler will receive their inputs by a <code>MultipleGraphLoader</code>.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">multiple_loader</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with the initial signature of the node labels and, if present, edge labels, the signature of the adjacency matrix, the</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    tolerance values by data type and which loader will be used for the graphs.</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Args:</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        node_config: The signature of the initial node labels of the graphs.</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        edge_config: The signature of the initial edge labels of the graphs.</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        matrix_type: The signature of the adjacency matrix of the graphs.</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        tolerance: The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        multiple_loader: True if the models generated by the mG compiler will receive their inputs by a ``MultipleGraphLoader``.</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_node_config</span> <span class="o">=</span> <span class="n">node_config</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_edge_config</span> <span class="o">=</span> <span class="n">edge_config</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_matrix_type</span> <span class="o">=</span> <span class="n">matrix_type</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_loader</span> <span class="o">=</span> <span class="n">multiple_loader</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.node_feature_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">node_feature_type</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.node_feature_type" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">node_feature_type</span><span class="p">:</span> <span class="n">DType</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the type of the node labels.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.node_feature_size" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">node_feature_size</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.node_feature_size" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">node_feature_size</span><span class="p">:</span> <span class="nb">int</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the dimension of the node labels.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.edge_feature_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">edge_feature_type</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.edge_feature_type" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">edge_feature_type</span><span class="p">:</span> <span class="n">DType</span> <span class="o">|</span> <span class="kc">None</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the type of the edge labels, if present.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.edge_feature_size" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">edge_feature_size</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.edge_feature_size" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">edge_feature_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the dimension of the edge labels, if present.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.matrix_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">matrix_type</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.matrix_type" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">matrix_type</span><span class="p">:</span> <span class="n">DType</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the type of the adjacency matrix.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.use_edges" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">use_edges</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.use_edges" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">use_edges</span><span class="p">:</span> <span class="nb">bool</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the mG compiler expects edge labels in the graph.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.tolerance" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">tolerance</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.tolerance" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the mapping between types and tolerance values.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.use_multiple_loader" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">use_multiple_loader</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.use_multiple_loader" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">use_multiple_loader</span><span class="p">:</span> <span class="nb">bool</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the mG compiler expects the usage of the <code>MultipleGraphLoader</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="libmg.compiler.CompilerConfig.input_spec" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">input_spec</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.input_spec" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_spec</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">TensorSpec</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the input signature that the mG compiler expects for every model it will produce.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.CompilerConfig.xa_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">xa_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.xa_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">xa_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a <code>CompilationConfig</code> object that tells the mG compiler to expect node labels but no edge labels in the graph
 and the use of the <code>SingleGraphLoader</code> for the inputs to the model.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.NodeConfig" href="#libmg.compiler.NodeConfig">NodeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial node labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>matrix_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the adjacency matrix of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>tolerance</code></b>
            (<code>dict[str, float]</code>)
        –
        <div class="doc-md-description">
          <p>The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="k">def</span> <span class="nf">xa_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span><span class="p">:</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ``CompilationConfig`` object that tells the mG compiler to expect node labels but no edge labels in the graph</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">     and the use of the ``SingleGraphLoader`` for the inputs to the model.</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">    Args:</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        node_config: The signature of the initial node labels of the graphs.</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        matrix_type: The signature of the adjacency matrix of the graphs.</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        tolerance: The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">return</span> <span class="n">CompilerConfig</span><span class="p">(</span><span class="n">node_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.CompilerConfig.xai_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">xai_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.xai_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">xai_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a <code>CompilationConfig</code> object that tells the mG compiler to expect nodes labels but no edge labels in the graph
 and the use of the <code>MultipleGraphLoader</code> for the inputs to the model.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.NodeConfig" href="#libmg.compiler.NodeConfig">NodeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial node labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>matrix_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the adjacency matrix of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>tolerance</code></b>
            (<code>dict[str, float]</code>)
        –
        <div class="doc-md-description">
          <p>The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="k">def</span> <span class="nf">xai_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span><span class="p">:</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ``CompilationConfig`` object that tells the mG compiler to expect nodes labels but no edge labels in the graph</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">     and the use of the ``MultipleGraphLoader`` for the inputs to the model.</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Args:</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        node_config: The signature of the initial node labels of the graphs.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        matrix_type: The signature of the adjacency matrix of the graphs.</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        tolerance: The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">return</span> <span class="n">CompilerConfig</span><span class="p">(</span><span class="n">node_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.CompilerConfig.xae_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">xae_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.xae_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">xae_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a <code>CompilationConfig</code> object that tells the mG compiler to expect node labels and edge labels in the graph
 and the use of the <code>SingleGraphLoader</code> for the inputs to the model.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.NodeConfig" href="#libmg.compiler.NodeConfig">NodeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial node labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>edge_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.EdgeConfig" href="#libmg.compiler.EdgeConfig">EdgeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial edge labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>matrix_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the adjacency matrix of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>tolerance</code></b>
            (<code>dict[str, float]</code>)
        –
        <div class="doc-md-description">
          <p>The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="k">def</span> <span class="nf">xae_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span><span class="p">:</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ``CompilationConfig`` object that tells the mG compiler to expect node labels and edge labels in the graph</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">     and the use of the ``SingleGraphLoader`` for the inputs to the model.</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Args:</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        node_config: The signature of the initial node labels of the graphs.</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        edge_config: The signature of the initial edge labels of the graphs.</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        matrix_type: The signature of the adjacency matrix of the graphs.</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        tolerance: The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">return</span> <span class="n">CompilerConfig</span><span class="p">(</span><span class="n">node_config</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.CompilerConfig.xaei_config" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">xaei_config</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#libmg.compiler.CompilerConfig.xaei_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">xaei_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a <code>CompilationConfig</code> object that tells the mG compiler to expect node labels and edge labels in the graph
 and the use of the <code>MultipleGraphLoader</code> for the inputs to the model.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>node_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.NodeConfig" href="#libmg.compiler.NodeConfig">NodeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial node labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>edge_config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.EdgeConfig" href="#libmg.compiler.EdgeConfig">EdgeConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the initial edge labels of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>matrix_type</code></b>
            (<code><span title="tensorflow.DType">DType</span></code>)
        –
        <div class="doc-md-description">
          <p>The signature of the adjacency matrix of the graphs.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>tolerance</code></b>
            (<code>dict[str, float]</code>)
        –
        <div class="doc-md-description">
          <p>The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="nd">@staticmethod</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="k">def</span> <span class="nf">xaei_config</span><span class="p">(</span><span class="n">node_config</span><span class="p">:</span> <span class="n">NodeConfig</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">:</span> <span class="n">EdgeConfig</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">DType</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">CompilerConfig</span><span class="p">:</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a ``CompilationConfig`` object that tells the mG compiler to expect node labels and edge labels in the graph</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">     and the use of the ``MultipleGraphLoader`` for the inputs to the model.</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    Args:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        node_config: The signature of the initial node labels of the graphs.</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        edge_config: The signature of the initial edge labels of the graphs.</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        matrix_type: The signature of the adjacency matrix of the graphs.</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        tolerance: The tolerance values for the data types (typically floats) that require an approximate fixed point solution.</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">return</span> <span class="n">CompilerConfig</span><span class="p">(</span><span class="n">node_config</span><span class="p">,</span> <span class="n">edge_config</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="libmg.compiler.MGCompiler" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">MGCompiler</span>


<a href="#libmg.compiler.MGCompiler" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">MGCompiler</span><span class="p">(</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">psi_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Psi</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Psi</span><span class="p">]],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="n">sigma_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sigma</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Sigma</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Sigma</span><span class="p">]],</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="n">phi_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Phi</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Phi</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Phi</span><span class="p">]],</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">CompilerConfig</span><span class="p">,</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">)</span>
</span></code></pre></div>

  <div class="doc doc-contents ">

  
      <p>The compiler for mG programs.</p>
<p>A program is transformed into a TensorFlow model using the <code>compile</code> method.</p>



  <p>Attributes:</p>
  <ul>
      <li class="field-body">
        <b><code><span title="libmg.compiler.MGCompiler.config">config</span></code></b>
        –
        <div class="doc-md-description">
          <p>The configuration for this compiler instance.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="libmg.compiler.MGCompiler.model_inputs">model_inputs</span></code></b>
        –
        <div class="doc-md-description">
          <p>The input layers for the models generated by the compiler.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="libmg.compiler.MGCompiler.model_input_spec">model_input_spec</span></code></b>
        –
        <div class="doc-md-description">
          <p>The input signature for the models generated by the compiler.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="libmg.compiler.MGCompiler.dummy_dataset">dummy_dataset</span></code></b>
        –
        <div class="doc-md-description">
          <p>The dataset used to trace the models generated by the compiler.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code><span title="libmg.compiler.MGCompiler.visitor">visitor</span></code></b>
        –
        <div class="doc-md-description">
          <p>The visitor that traverses an expression tree to construct the model.</p>
        </div>
      </li>
  </ul>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>psi_functions</code></b>
            (<code>dict[str, <span title="libmg.compiler.functions.Psi">Psi</span> | <span title="typing.Callable">Callable</span>[[], <span title="libmg.compiler.functions.Psi">Psi</span>] | <span title="typing.Callable">Callable</span>[[str], <span title="libmg.compiler.functions.Psi">Psi</span>]]</code>)
        –
        <div class="doc-md-description">
          <p>The psi functions that this compiler will recognize.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sigma_functions</code></b>
            (<code>dict[str, <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Sigma" href="#libmg.compiler.Sigma">Sigma</a> | <span title="typing.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Sigma" href="#libmg.compiler.Sigma">Sigma</a>] | <span title="typing.Callable">Callable</span>[[str], <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Sigma" href="#libmg.compiler.Sigma">Sigma</a>]]</code>)
        –
        <div class="doc-md-description">
          <p>The sigma functions that this compiler will recognize.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>phi_functions</code></b>
            (<code>dict[str, <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Phi" href="#libmg.compiler.Phi">Phi</a> | <span title="typing.Callable">Callable</span>[[], <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Phi" href="#libmg.compiler.Phi">Phi</a>] | <span title="typing.Callable">Callable</span>[[str], <a class="autorefs autorefs-internal" title="libmg.compiler.functions.Phi" href="#libmg.compiler.Phi">Phi</a>]]</code>)
        –
        <div class="doc-md-description">
          <p>The phi functions that this compiler will recognize.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>config</code></b>
            (<code><a class="autorefs autorefs-internal" title="libmg.compiler.compiler.CompilerConfig" href="#libmg.compiler.CompilerConfig">CompilerConfig</a></code>)
        –
        <div class="doc-md-description">
          <p>The configuration for the compiler.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
                  <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1097"><a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Psi</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Psi</span><span class="p">]],</span>
</span><span id="__span-0-1098"><a id="__codelineno-0-1098" name="__codelineno-0-1098"></a>             <span class="n">sigma_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sigma</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Sigma</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Sigma</span><span class="p">]],</span>
</span><span id="__span-0-1099"><a id="__codelineno-0-1099" name="__codelineno-0-1099"></a>             <span class="n">phi_functions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Phi</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="n">Phi</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Phi</span><span class="p">]],</span> <span class="n">config</span><span class="p">:</span> <span class="n">CompilerConfig</span><span class="p">):</span>
</span><span id="__span-0-1100"><a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the instance with the psi, phi and sigma functions that this compiler will recognize and the compiler configuration.</span>
</span><span id="__span-0-1101"><a id="__codelineno-0-1101" name="__codelineno-0-1101"></a>
</span><span id="__span-0-1102"><a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1103"><a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">        psi_functions: The psi functions that this compiler will recognize.</span>
</span><span id="__span-0-1104"><a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">        sigma_functions: The sigma functions that this compiler will recognize.</span>
</span><span id="__span-0-1105"><a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">        phi_functions: The phi functions that this compiler will recognize.</span>
</span><span id="__span-0-1106"><a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">        config: The configuration for the compiler.</span>
</span><span id="__span-0-1107"><a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1108"><a id="__codelineno-0-1108" name="__codelineno-0-1108"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">node_feature_type</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span> <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="n">edge_feature_type</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
</span><span id="__span-0-1109"><a id="__codelineno-0-1109" name="__codelineno-0-1109"></a>        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">set_floatx</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</span><span id="__span-0-1110"><a id="__codelineno-0-1110" name="__codelineno-0-1110"></a>    <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">node_feature_type</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">float16</span> <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="n">edge_feature_type</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">float16</span><span class="p">:</span>
</span><span id="__span-0-1111"><a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">set_floatx</span><span class="p">(</span><span class="s1">&#39;float16&#39;</span><span class="p">)</span>
</span><span id="__span-0-1112"><a id="__codelineno-0-1112" name="__codelineno-0-1112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
</span><span id="__span-0-1113"><a id="__codelineno-0-1113" name="__codelineno-0-1113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">node_feature_size</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;INPUT_X&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">node_feature_type</span><span class="p">),</span>
</span><span id="__span-0-1114"><a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>                         <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;INPUT_A&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">)]</span>
</span><span id="__span-0-1115"><a id="__codelineno-0-1115" name="__codelineno-0-1115"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_edges</span><span class="p">:</span>
</span><span id="__span-0-1116"><a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">edge_feature_size</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;INPUT_E&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">edge_feature_type</span><span class="p">))</span>
</span><span id="__span-0-1117"><a id="__codelineno-0-1117" name="__codelineno-0-1117"></a>    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_multiple_loader</span><span class="p">:</span>
</span><span id="__span-0-1118"><a id="__codelineno-0-1118" name="__codelineno-0-1118"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;INPUT_I&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
</span><span id="__span-0-1119"><a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">model_input_spec</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">input_spec</span>
</span><span id="__span-0-1120"><a id="__codelineno-0-1120" name="__codelineno-0-1120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">dummy_dataset</span> <span class="o">=</span> <span class="n">DummyDataset</span><span class="p">(</span><span class="n">NodeConfig</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">node_feature_type</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">node_feature_size</span><span class="p">),</span> <span class="n">config</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">,</span>
</span><span id="__span-0-1121"><a id="__codelineno-0-1121" name="__codelineno-0-1121"></a>                                      <span class="n">EdgeConfig</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">edge_feature_type</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">edge_feature_size</span><span class="p">)</span> <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">use_edges</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="__span-0-1122"><a id="__codelineno-0-1122" name="__codelineno-0-1122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TreeToTF</span><span class="p">(</span><span class="n">FunctionDict</span><span class="p">(</span><span class="n">psi_functions</span><span class="p">),</span> <span class="n">FunctionDict</span><span class="p">(</span><span class="n">sigma_functions</span><span class="p">),</span> <span class="n">FunctionDict</span><span class="p">(</span><span class="n">phi_functions</span><span class="p">),</span> <span class="n">config</span><span class="o">.</span><span class="n">tolerance</span><span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.MGCompiler.compile" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">compile</span>


<a href="#libmg.compiler.MGCompiler.compile" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">compile</span><span class="p">(</span><span class="nf">expr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">memoize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MGModel</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Compiles a mG program into a TensorFlow model.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>expr</code></b>
            (<code>str | <span title="lark.Tree">Tree</span></code>)
        –
        <div class="doc-md-description">
          <p>The mG program to compile.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>verbose</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If true, prints some debugging information during the compilation step.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>memoize</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>If true, memoize intermediate outputs during compilation.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="libmg.compiler.compiler.MGModel">MGModel</span></code>
        –
        <div class="doc-md-description">
          <p>The TensorFlow model that implements <code>expr</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1198"><a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">memoize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MGModel</span><span class="p">:</span>
</span><span id="__span-0-1199"><a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compiles a mG program into a TensorFlow model.</span>
</span><span id="__span-0-1200"><a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
</span><span id="__span-0-1201"><a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1202"><a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">        expr: The mG program to compile.</span>
</span><span id="__span-0-1203"><a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">        verbose: If true, prints some debugging information during the compilation step.</span>
</span><span id="__span-0-1204"><a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">        memoize: If true, memoize intermediate outputs during compilation.</span>
</span><span id="__span-0-1205"><a id="__codelineno-0-1205" name="__codelineno-0-1205"></a>
</span><span id="__span-0-1206"><a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1207"><a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">        The TensorFlow model that implements ``expr``.</span>
</span><span id="__span-0-1208"><a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1209"><a id="__codelineno-0-1209" name="__codelineno-0-1209"></a>    <span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-0-1210"><a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>    <span class="n">e</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="__span-0-1211"><a id="__codelineno-0-1211" name="__codelineno-0-1211"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_edges</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_multiple_loader</span><span class="p">:</span>
</span><span id="__span-0-1212"><a id="__codelineno-0-1212" name="__codelineno-0-1212"></a>        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="__span-0-1213"><a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-1214"><a id="__codelineno-0-1214" name="__codelineno-0-1214"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_edges</span><span class="p">:</span>
</span><span id="__span-0-1215"><a id="__codelineno-0-1215" name="__codelineno-0-1215"></a>        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-1216"><a id="__codelineno-0-1216" name="__codelineno-0-1216"></a>        <span class="n">i</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-1217"><a id="__codelineno-0-1217" name="__codelineno-0-1217"></a>    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_multiple_loader</span><span class="p">:</span>
</span><span id="__span-0-1218"><a id="__codelineno-0-1218" name="__codelineno-0-1218"></a>        <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="__span-0-1219"><a id="__codelineno-0-1219" name="__codelineno-0-1219"></a>        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-1220"><a id="__codelineno-0-1220" name="__codelineno-0-1220"></a>
</span><span id="__span-0-1221"><a id="__codelineno-0-1221" name="__codelineno-0-1221"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">IntermediateOutput</span><span class="p">(</span><span class="n">mg_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;__INPUT__&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,),</span> <span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">memoize</span><span class="p">)</span>
</span><span id="__span-0-1222"><a id="__codelineno-0-1222" name="__codelineno-0-1222"></a>    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
</span><span id="__span-0-1223"><a id="__codelineno-0-1223" name="__codelineno-0-1223"></a>    <span class="n">normalized_expr_tree</span> <span class="o">=</span> <span class="n">mg_normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">expr</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span> <span class="k">else</span> <span class="n">mg_parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
</span><span id="__span-0-1224"><a id="__codelineno-0-1224" name="__codelineno-0-1224"></a>    <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">normalized_expr_tree</span><span class="p">)</span>
</span><span id="__span-0-1225"><a id="__codelineno-0-1225" name="__codelineno-0-1225"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">MGModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">normalized_expr_tree</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span>
</span><span id="__span-0-1226"><a id="__codelineno-0-1226" name="__codelineno-0-1226"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">used_psi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">used_phi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">visitor</span><span class="o">.</span><span class="n">used_sigma</span><span class="p">)</span>
</span><span id="__span-0-1227"><a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>    <span class="k">if</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-1228"><a id="__codelineno-0-1228" name="__codelineno-0-1228"></a>        <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">expand_nested</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_trainable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-1229"><a id="__codelineno-0-1229" name="__codelineno-0-1229"></a>    <span class="k">return</span> <span class="n">model</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="libmg.compiler.MGCompiler.trace" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">trace</span>


<a href="#libmg.compiler.MGCompiler.trace" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">trace</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">MGModel</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;call&#39;</span><span class="p">,</span> <span class="s1">&#39;predict&#39;</span><span class="p">,</span> <span class="s1">&#39;predict_on_batch&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MGModel</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Performs tracing on the model, and returns it, together with the time in seconds elapsed for tracing.</p>
<p>The <code>predict_on_batch</code> API cannot be used if the graphs have edge labels as of TF 2.4.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>model</code></b>
            (<code><span title="libmg.compiler.compiler.MGModel">MGModel</span></code>)
        –
        <div class="doc-md-description">
          <p>The model to trace.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>api</code></b>
            (<code><span title="typing.Literal">Literal</span>[&#39;call&#39;, &#39;predict&#39;, &#39;predict_on_batch&#39;]</code>)
        –
        <div class="doc-md-description">
          <p>The TensorFlow API intended to be used with the model. Options are <code>call</code> for the <code>model()</code> API,
<code>predict</code> for the <code>model.predict()</code> API and <code>predict_on_batch</code> for the <code>model.predict_on_batch()</code> API.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.Tuple">Tuple</span>[<span title="libmg.compiler.compiler.MGModel">MGModel</span> | <span title="typing.Callable">Callable</span>, float]</code>
        –
        <div class="doc-md-description">
          <p>The model and the elapsed time in seconds for tracing.</p>
      </div>
      </li>
  </ul>



  <p>Raises:</p>
  <ul>
      <li class="field-body">
            <code>ValueError</code>
          –
        <div class="doc-md-description">
          <p>The <code>predict_on_batch</code> API has been selected and the compiler's configuration is set for graphs with edge labels.</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/compiler.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1231"><a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">MGModel</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;call&quot;</span><span class="p">,</span> <span class="s2">&quot;predict&quot;</span><span class="p">,</span> <span class="s2">&quot;predict_on_batch&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">MGModel</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
</span><span id="__span-0-1232"><a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs tracing on the model, and returns it, together with the time in seconds elapsed for tracing.</span>
</span><span id="__span-0-1233"><a id="__codelineno-0-1233" name="__codelineno-0-1233"></a>
</span><span id="__span-0-1234"><a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    The ``predict_on_batch`` API cannot be used if the graphs have edge labels as of TF 2.4.</span>
</span><span id="__span-0-1235"><a id="__codelineno-0-1235" name="__codelineno-0-1235"></a>
</span><span id="__span-0-1236"><a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">    Args:</span>
</span><span id="__span-0-1237"><a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">        model: The model to trace.</span>
</span><span id="__span-0-1238"><a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">        api: The TensorFlow API intended to be used with the model. Options are ``call`` for the ``model()`` API,</span>
</span><span id="__span-0-1239"><a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">            ``predict`` for the ``model.predict()`` API and ``predict_on_batch`` for the ``model.predict_on_batch()`` API.</span>
</span><span id="__span-0-1240"><a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
</span><span id="__span-0-1241"><a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-1242"><a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        The model and the elapsed time in seconds for tracing.</span>
</span><span id="__span-0-1243"><a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
</span><span id="__span-0-1244"><a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">    Raises:</span>
</span><span id="__span-0-1245"><a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">        ValueError: The ``predict_on_batch`` API has been selected and the compiler&#39;s configuration is set for graphs with edge labels.</span>
</span><span id="__span-0-1246"><a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-1247"><a id="__codelineno-0-1247" name="__codelineno-0-1247"></a>    <span class="k">if</span> <span class="n">api</span> <span class="o">==</span> <span class="s1">&#39;predict_on_batch&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_edges</span><span class="p">:</span>
</span><span id="__span-0-1248"><a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The predict_on_batch API, as of TF2.4, isn&#39;t compatible with graphs with edge labels.&quot;</span><span class="p">)</span>
</span><span id="__span-0-1249"><a id="__codelineno-0-1249" name="__codelineno-0-1249"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_multiple_loader</span><span class="p">:</span>
</span><span id="__span-0-1250"><a id="__codelineno-0-1250" name="__codelineno-0-1250"></a>        <span class="n">dummy_loader</span> <span class="o">=</span> <span class="n">MultipleGraphLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dummy_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1251"><a id="__codelineno-0-1251" name="__codelineno-0-1251"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-1252"><a id="__codelineno-0-1252" name="__codelineno-0-1252"></a>        <span class="n">dummy_loader</span> <span class="o">=</span> <span class="n">SingleGraphLoader</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dummy_dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-1253"><a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>    <span class="n">traced_model</span> <span class="o">=</span> <span class="n">MGCompiler</span><span class="o">.</span><span class="n">_graph_mode_constructor</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_input_spec</span><span class="p">,</span> <span class="n">api</span><span class="p">)</span>
</span><span id="__span-0-1254"><a id="__codelineno-0-1254" name="__codelineno-0-1254"></a>    <span class="n">compile_time</span> <span class="o">=</span> <span class="n">MGCompiler</span><span class="o">.</span><span class="n">_dummy_run</span><span class="p">(</span><span class="n">traced_model</span><span class="p">,</span> <span class="n">dummy_loader</span><span class="p">,</span> <span class="n">api</span><span class="p">)</span>
</span><span id="__span-0-1255"><a id="__codelineno-0-1255" name="__codelineno-0-1255"></a>    <span class="k">return</span> <span class="n">traced_model</span><span class="p">,</span> <span class="n">compile_time</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="libmg.compiler.make_uoperator" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_uoperator</span>


<a href="#libmg.compiler.make_uoperator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_uoperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a unary operator psi function.</p>
<p>A unary operator is equivalent to a <code>PsiLocal</code>.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[<span title="tensorflow.Tensor">Tensor</span>], <span title="tensorflow.Tensor">Tensor</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The unary operator function. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input a tensor X with shape <code>(n_nodes, n_node_features)</code>, containing the labels of
every node in the graph, and return a tensor of shape <code>(n_nodes, n_new_node_features)</code>, containing the transformed labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the unary operator.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>type</code>
        –
        <div class="doc-md-description">
          <p>A subclass of Operator that implements the operator.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-582"><a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="k">def</span> <span class="nf">make_uoperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
</span><span id="__span-0-583"><a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a unary operator psi function.</span>
</span><span id="__span-0-584"><a id="__codelineno-0-584" name="__codelineno-0-584"></a>
</span><span id="__span-0-585"><a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    A unary operator is equivalent to a ``PsiLocal``.</span>
</span><span id="__span-0-586"><a id="__codelineno-0-586" name="__codelineno-0-586"></a>
</span><span id="__span-0-587"><a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    Args:</span>
</span><span id="__span-0-588"><a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        op: The unary operator function. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-589"><a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">            rules. The function is expected to take in input a tensor X with shape ``(n_nodes, n_node_features)``, containing the labels of</span>
</span><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">            every node in the graph, and return a tensor of shape ``(n_nodes, n_new_node_features)``, containing the transformed labels.</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">        name: The name of the unary operator.</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">        A subclass of Operator that implements the operator.</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;UOperator&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Operator</span><span class="p">,),</span> <span class="p">{</span><span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="n">func</span><span class="p">})</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="libmg.compiler.make_boperator" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_boperator</span>


<a href="#libmg.compiler.make_boperator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_boperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a binary operator psi function.</p>
<p>A binary operator is a binary local transformation of node labels, psi: (T, T) -&gt; U.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>op</code></b>
            (<code><span title="typing.Callable">Callable</span>[[<span title="tensorflow.Tensor">Tensor</span>, <span title="tensorflow.Tensor">Tensor</span>], <span title="tensorflow.Tensor">Tensor</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The binary operator function. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input two tensors X1, X2 with shape <code>(n_nodes, n_node_features/2)</code>. The first tensor contains for every
node the first half of the node features, while the second tensor contains the second half. The operator returns a tensor of shape
<code>(n_nodes, n_new_node_features)</code>, containing the transformed labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the binary operator.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>type</code>
        –
        <div class="doc-md-description">
          <p>A subclass of Operator that implements the operator.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="k">def</span> <span class="nf">make_boperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a binary operator psi function.</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">    A binary operator is a binary local transformation of node labels, psi: (T, T) -&gt; U.</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">    Args:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">        op: The binary operator function. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">            rules. The function is expected to take in input two tensors X1, X2 with shape ``(n_nodes, n_node_features/2)``. The first tensor contains for every</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">            node the first half of the node features, while the second tensor contains the second half. The operator returns a tensor of shape</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a><span class="sd">            ``(n_nodes, n_new_node_features)``, containing the transformed labels.</span>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">        name: The name of the binary operator.</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        A subclass of Operator that implements the operator.</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;BOperator&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Operator</span><span class="p">,),</span> <span class="p">{</span><span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="n">func</span><span class="p">})</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="libmg.compiler.make_koperator" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_koperator</span>


<a href="#libmg.compiler.make_koperator" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">make_koperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span>
</span></code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a k-ary operator psi function.</p>
<p>A k-ary operator is a k-ary local transformation of node labels, psi: (T^k) -&gt; U.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>op</code></b>
            (<code><span title="typing.Callable">Callable</span>[..., <span title="tensorflow.Tensor">Tensor</span>]</code>)
        –
        <div class="doc-md-description">
          <p>The k-ary operator function. The function must be compatible with TensorFlow's broadcasting
rules. The function is expected to take in input k tensors X1, X2, ..., Xk with shape <code>(n_nodes, n_node_features/k)</code>. The first tensor contains
for every node the first k of the node features, the second tensor contains the next k features, and so on. The operator returns a tensor of shape
<code>(n_nodes, n_new_node_features)</code>, containing the transformed labels.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str | None</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The name of the k-ary operator.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>type</code>
        –
        <div class="doc-md-description">
          <p>A subclass of Operator that implements the operator.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>libmg/compiler/functions.py</code></summary>
            <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="k">def</span> <span class="nf">make_koperator</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a k-ary operator psi function.</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a><span class="sd">    A k-ary operator is a k-ary local transformation of node labels, psi: (T^k) -&gt; U.</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="sd">    Args:</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="sd">        op: The k-ary operator function. The function must be compatible with TensorFlow&#39;s broadcasting</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a><span class="sd">            rules. The function is expected to take in input k tensors X1, X2, ..., Xk with shape ``(n_nodes, n_node_features/k)``. The first tensor contains</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a><span class="sd">            for every node the first k of the node features, the second tensor contains the next k features, and so on. The operator returns a tensor of shape</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a><span class="sd">            ``(n_nodes, n_new_node_features)``, containing the transformed labels.</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="sd">        name: The name of the k-ary operator.</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a><span class="sd">    Returns:</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a><span class="sd">        A subclass of Operator that implements the operator.</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-640"><a id="__codelineno-0-640" name="__codelineno-0-640"></a>
</span><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="k">return</span> <span class="n">op</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="n">name</span> <span class="ow">or</span> <span class="s2">&quot;KOperator&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">Operator</span><span class="p">,),</span> <span class="p">{</span><span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="n">func</span><span class="p">})</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 26, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../grammar/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Grammar Reference">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Grammar Reference
              </div>
            </div>
          </a>
        
        
          
          <a href="../data/" class="md-footer__link md-footer__link--next" aria-label="Next: data">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                data
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Matteo Belenchia – <a href="#__consent">Change cookie settings</a>
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/quasylab/mG" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  




<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
          
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
          
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          Github
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "toc.follow", "navigation.top", "search.suggest", "search.share", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>